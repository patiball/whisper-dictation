# Zadanie: Wygeneruj główny dokument ARCHITECTURE.md

## Data
2025-10-10 14:25

## Priorytet  
HIGH

## Status
⏳ W trakcie

## Kontekst
Diagram architecture-layers.mmd już istnieje ✅

## Cel
Utworzyć `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/docs/ARCHITECTURE.md`

## Wymagane pliki do przeczytania
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/docs/PROJECT_OVERVIEW.md`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/README.md`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/whisper-dictation.py`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/recorder.py`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/transcriber.py`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/device_manager.py`
- `/Users/mprzybyszewski/dev/ai-projects/whisper-dictation/mps_optimizer.py`

## Zawartość ARCHITECTURE.md

### 1. Wprowadzenie (2-3 akapity)
Krótki opis architektury aplikacji whisper-dictation.

### 2. Warstwy systemu

#### Warstwa Prezentacji
- **Odpowiedzialność**: Interfejs użytkownika, menu bar, ikony systemowe
- **Komponenty**: Rumps menu bar, ikony statusu
- **Zależności**: macOS APIs

#### Warstwa Kontroli  
- **Odpowiedzialność**: Zarządzanie stanem aplikacji, obsługa zdarzeń
- **Komponenty**: Główna pętla, keyboard listeners
- **Zależności**: Pynput

#### Warstwa Biznesowa
- **Odpowiedzialność**: Logika nagrywania i transkrypcji
- **Komponenty**: 
  - Recorder - nagrywanie audio
  - Transcriber - transkrypcja Whisper
  - DeviceManager - optymalizacja M1/M2
  - MPSOptimizer - akceleracja GPU
- **Zależności**: PyAudio, PyTorch, Whisper

#### Warstwa Danych
- **Odpowiedzialność**: Przechowywanie i cache
- **Komponenty**: Bufor audio (numpy), cache modeli
- **Zależności**: Brak

#### Warstwa Integracji
- **Odpowiedzialność**: Integracja z zewnętrznymi bibliotekami
- **Komponenty**: PyAudio, PyTorch, Whisper API, Pynput
- **Zależności**: Biblioteki systemowe

### 3. Komponenty główne

Dla każdego: nazwa, odpowiedzialność, kluczowe metody (2-3), zależności

- **WhisperDictation** (main app)
- **Recorder** 
- **SpeechTranscriber**
- **DeviceManager**
- **MPSOptimizer**

### 4. Diagram architektury
Link do: `./diagrams/architecture-layers.mmd`

### 5. Wzorce projektowe
Opisz rzeczywiście użyte wzorce (sprawdź w kodzie):
- Singleton?
- Observer?
- Strategy?
- Inne?

**WAŻNE**: Nie wymyślaj - bazuj na kodzie!

### 6. Kluczowe decyzje architektoniczne

Format ADR-lite dla każdej:

**Decyzja 1: Dwie implementacje (Python vs C++)**
- Kontekst: Potrzeba akceleracji GPU M1
- Decyzja: Równoległe implementacje
- Konsekwencje: + elastyczność, - duplikacja kodu
- Status: Aktywna

**Decyzja 2: Offline processing**
- Kontekst: Prywatność użytkowników
- Decyzja: Brak wysyłania danych
- Konsekwencje: + prywatność, - brak cloud features
- Status: Aktywna

**Decyzja 3: Device Management**
- Kontekst: Problemy z MPS na M1
- Decyzja: Dedykowany DeviceManager
- Konsekwencje: + stabilność, + performance
- Status: Aktywna

### 7. Obszary ryzyka
- Performance bottlenecks: ładowanie modeli
- Memory usage: duże modele Whisper
- Thread safety: nagrywanie vs transkrypcja
- MPS compatibility issues

### 8. Powiązane dokumenty
```markdown
## Powiązane dokumenty

- [README](./README.md)
- [Przegląd projektu](./PROJECT_OVERVIEW.md)
- [Przepływy danych](./DATA_FLOW.md) *(planowane)*
- [Diagram warstw](./diagrams/architecture-layers.mmd)
- [Diagram systemowy](./diagrams/system-overview.mmd)
```

## Wymagania
- **Język**: Polski
- **Format**: Markdown
- **Długość**: 500-800 linii
- **Styl**: Techniczny, konkretny
- **Kod**: Przykłady z rzeczywistego kodu

## Walidacja
1. Wszystkie sekcje wypełnione
2. Linki działają (względne ścieżki)
3. Sekcja "Powiązane dokumenty" obecna
4. Bazowane na prawdziwym kodzie (nie fikcja)
